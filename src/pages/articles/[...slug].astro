---
import { getCollection } from 'astro:content';
import Base from '../../layouts/base.astro';

export async function getStaticPaths() {
  const articles = await getCollection('articles');
  return articles.map((article) => ({
    params: { slug: article.slug },
    props: article,
  }));
}

const article = Astro.props;
const { Content } = await article.render();

function formatDate(date: Date): string {
  return date.toLocaleDateString('en-US', { 
    year: 'numeric', 
    month: 'long', 
    day: 'numeric' 
  });
}
---

<Base 
  title={`${article.data.title} - Saigon Fencing Club`}
  description={article.data.description}
  keywords={article.data.tags ? article.data.tags.join(', ') + ', fencing, Ho Chi Minh City' : 'fencing, Ho Chi Minh City'}
  image={article.data.image}
>
  <!-- Structured Data for Article -->
  <script type="application/ld+json" slot="head">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": `${article.data.title}`,
    "description": `${article.data.description}`,
    "author": {
      "@type": "Person",
      "name": `${article.data.author}`
    },
    "publisher": {
      "@type": "Organization",
      "name": "Saigon Fencing Club",
      "logo": {
        "@type": "ImageObject",
        "url": "https://saigonfencing.com/legacy/logo_trans_web.png"
      }
    },
    "datePublished": `${article.data.publishDate.toISOString()}`,
    "dateModified": `${article.data.publishDate.toISOString()}`,
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": `https://saigonfencing.com/articles/${article.slug}`
    }
  }
  </script>

  <!-- Navigation Header - Exact same as homepage -->
  <header class="sticky top-0 z-50 w-full border-b border-neutral-200 bg-white/90 backdrop-blur">
    <div class="container mx-auto flex max-w-7xl items-center justify-between px-4 py-4 sm:px-6 lg:px-8">
      <a class="flex flex-shrink-0 items-center" href="/" aria-label="Saigon Fencing home">
        <img src="/legacy/logo_trans_web.png" alt="Saigon Fencing Club logo" class="h-16 w-auto max-h-20" width="80" height="80" loading="lazy" />
      </a>
      <nav class="ml-auto" aria-label="Primary navigation">
        <ul class="flex flex-wrap items-center justify-end gap-x-6 gap-y-3 text-[10px] font-medium uppercase tracking-[0.2em] text-neutral-600 md:text-[11px]" style="font-family: 'Poppins', Helvetica, Arial, sans-serif;">
          <li><a class="text-neutral-600 transition-colors duration-200 hover:!text-brand-gold" href="/">Home</a></li>
          <li><a class="text-neutral-600 transition-colors duration-200 hover:!text-brand-gold" href="/#About">About</a></li>
          <li><a class="text-neutral-600 transition-colors duration-200 hover:!text-brand-gold" href="/#Classes">Classes</a></li>
          <li><a class="text-neutral-600 transition-colors duration-200 hover:!text-brand-gold" href="/#Schedules">Schedules</a></li>
          <li><a class="text-neutral-600 transition-colors duration-200 hover:!text-brand-gold" href="/#Rankings">Rankings</a></li>
          <li><a class="text-neutral-600 transition-colors duration-200 hover:!text-brand-gold" href="/#Contact-Us">Contact Us</a></li>
          <li><a class="text-neutral-600 transition-colors duration-200 hover:!text-brand-gold" href="/articles">Articles</a></li>
        </ul>
      </nav>
    </div>
  </header> <!-- #main-header -->

  <div id="et-main-area">
    <div id="main-content">
      <div class="container mx-auto flex max-w-7xl px-4 sm:px-6 lg:px-8" style="padding-top: 100px;">
        <div id="content-area" class="clearfix w-full">
          <div id="left-area" class="w-full">
            
            <!-- Breadcrumb -->
            <nav class="breadcrumb" style="margin: 20px 0; font-size: 14px; color: #666;">
              <a href="/" style="color: #b39d64; text-decoration: none;">Home</a>
              <span style="margin: 0 10px;">›</span>
              <a href="/articles" style="color: #b39d64; text-decoration: none;">Articles</a>
              <span style="margin: 0 10px;">›</span>
              <span>{article.data.title}</span>
            </nav>

            <!-- Article Header -->
            <div class="et_pb_section et_pb_section_0 et_section_regular" style="padding: 40px 0;">
              <div class="et_pb_row et_pb_row_0">
                <div class="et_pb_column et_pb_column_4_4 et_pb_column_0 et_pb_css_mix_blend_mode_passthrough et-last-child">
                  
                  <!-- Article Meta -->
                  <div class="article-meta" style="text-align: center; margin-bottom: 30px;">
                    <div style="margin-bottom: 15px;">
                      <span style="color: #b39d64; font-size: 14px; font-weight: 600;">
                        {formatDate(article.data.publishDate)}
                      </span>
                      <span style="color: #666; margin-left: 15px; font-size: 14px;">
                        by <strong>{article.data.author}</strong>
                      </span>
                      {article.data.featured && (
                        <span style="background: #b39d64; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; margin-left: 15px; font-weight: 600;">
                          FEATURED ARTICLE
                        </span>
                      )}
                    </div>
                    
                    {article.data.tags && (
                      <div class="article-tags" style="margin-bottom: 20px;">
                        {article.data.tags.map((tag) => (
                          <span class="tag" style="background: #f0f0f0; color: #666; padding: 6px 12px; border-radius: 20px; font-size: 12px; margin: 0 5px; display: inline-block;">
                            #{tag}
                          </span>
                        ))}
                      </div>
                    )}
                  </div>

                  <!-- Article Title -->
                  <div class="et_pb_module et_pb_text et_pb_text_0 et_pb_text_align_center et_pb_bg_layout_light">
                    <div class="et_pb_text_inner">
                      <h1 style="text-align: center; font-family: Poppins; color: #333; margin-bottom: 20px; font-size: 36px; line-height: 1.2;">
                        {article.data.title}
                      </h1>
                      <p style="text-align: center; font-size: 18px; color: #666; max-width: 700px; margin: 0 auto; line-height: 1.6;">
                        {article.data.description}
                      </p>
                    </div>
                  </div>

                  {article.data.image && (
                    <div class="article-featured-image" style="text-align: center; margin: 40px 0;">
                      <div style="max-width: 200px; margin: 0 auto; padding: 40px; background: linear-gradient(135deg, #b39d64, #8a7a4f); border-radius: 10px;">
                        <img src={article.data.image} alt={article.data.title} style="max-width: 100%; height: auto; filter: brightness(0) invert(1);" />
                      </div>
                    </div>
                  )}
                </div>
              </div>
            </div>

            <!-- Article Content -->
            <div class="et_pb_section et_pb_section_1 et_section_regular" style="padding: 0 0 60px 0;">
              <div class="et_pb_row et_pb_row_1">
                <div class="et_pb_column et_pb_column_4_4 et_pb_column_1 et_pb_css_mix_blend_mode_passthrough et-last-child">
                  <div class="et_pb_module et_pb_text et_pb_text_1 et_pb_bg_layout_light">
                    <div class="et_pb_text_inner">
                      <article class="article-content" style="max-width: 800px; margin: 0 auto; font-size: 16px; line-height: 1.8; color: #444;">
                        <Content />
                      </article>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Call to Action -->
            <div class="et_pb_section et_pb_section_2 et_section_regular" style="background: #f8f9fa; padding: 60px 0;">
              <div class="et_pb_row et_pb_row_2">
                <div class="et_pb_column et_pb_column_4_4 et_pb_column_2 et_pb_css_mix_blend_mode_passthrough et-last-child">
                  <div class="et_pb_module et_pb_text et_pb_text_2 et_pb_text_align_center et_pb_bg_layout_light">
                    <div class="et_pb_text_inner">
                      <h3 style="text-align: center; font-family: Poppins; color: #333; margin-bottom: 20px;">
                        Ready to Start Your Fencing Journey?
                      </h3>
                      <p style="text-align: center; color: #666; margin-bottom: 30px; font-size: 16px;">
                        Join Saigon Fencing Club and learn from experienced coaches in a supportive environment.
                      </p>
                      <div style="text-align: center;">
                        <a href="mailto:saigon.fencing@gmail.com" style="display: inline-block; background: #b39d64; color: white; padding: 15px 30px; border-radius: 5px; text-decoration: none; font-weight: 600; margin: 0 10px; transition: background 0.3s ease;">
                          Book a Trial Class
                        </a>
                        <a href="/articles" style="display: inline-block; border: 2px solid #b39d64; color: #b39d64; padding: 13px 30px; border-radius: 5px; text-decoration: none; font-weight: 600; margin: 0 10px; transition: all 0.3s ease;">
                          More Articles
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <style>
    /* Brand gold color for hover effects */
    .hover\\:text-brand-gold:hover {
      color: #b39d64 !important;
    }

    /* Article Content Styling */
    .article-content h1 {
      color: #333;
      font-family: Poppins;
      font-size: 32px;
      margin: 40px 0 20px 0;
      border-bottom: 3px solid #b39d64;
      padding-bottom: 10px;
    }
    
    .article-content h2 {
      color: #333;
      font-family: Poppins;
      font-size: 28px;
      margin: 35px 0 15px 0;
      color: #b39d64;
    }
    
    .article-content h3 {
      color: #333;
      font-family: Poppins;
      font-size: 24px;
      margin: 30px 0 15px 0;
    }
    
    .article-content h4 {
      color: #333;
      font-family: Poppins;
      font-size: 20px;
      margin: 25px 0 10px 0;
      color: #8a7a4f;
    }
    
    .article-content p {
      margin-bottom: 20px;
      text-align: justify;
    }
    
    .article-content ul, .article-content ol {
      margin: 20px 0;
      padding-left: 30px;
    }
    
    .article-content li {
      margin-bottom: 10px;
    }
    
    .article-content strong {
      color: #333;
      font-weight: 600;
    }
    
    .article-content em {
      font-style: italic;
    }
    
    .article-content blockquote {
      background: #f8f9fa;
      border-left: 4px solid #b39d64;
      padding: 20px;
      margin: 30px 0;
      font-style: italic;
      color: #666;
    }
    
    .article-content code {
      background: #f1f1f1;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
    }
    
    .breadcrumb a:hover {
      color: #8a7a4f !important;
    }
    
    .cta-buttons a:hover {
      transform: translateY(-2px);
    }
    
    .cta-buttons a:first-child:hover {
      background: #8a7a4f !important;
    }
    
    .cta-buttons a:last-child:hover {
      background: #b39d64 !important;
      color: white !important;
    }

    @media (max-width: 768px) {
      .article-content h1 {
        font-size: 28px;
      }
      
      .article-content h2 {
        font-size: 24px;
      }
      
      .cta-buttons a {
        display: block !important;
        margin: 10px 0 !important;
        text-align: center;
      }
    }
  </style>
</Base>